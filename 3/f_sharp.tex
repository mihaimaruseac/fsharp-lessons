\documentclass{beamer}

\usepackage{hyperref}
\mode<presentation>

\title{F\#.3 : Immutable Data Structures}
\author{Mihai Maruseac, ROSEdu\\mihai@rosedu.org}

\setbeamertemplate{frametitle continuation}[from second]
\setbeamertemplate{footline}[frame number]

\begin{document}

\maketitle

\begin{frame}
  \tableofcontents
\end{frame}

\begin{frame}{Last time...}
  \begin{itemize}[<+->]
    \item list and sequences
    \item curry functions
    \item point-free programming
    \item \texttt{take}, \texttt{skip}
    \item \texttt{takeWhile}, \texttt{skipWhile}
    \item \texttt{map}
    \item \texttt{filter}
    \item \texttt{fold}
  \end{itemize}
\end{frame}

\begin{frame}{Last Assignment}
  \begin{block}{Problem from Project Euler}
  A palindromic number reads the same both ways. The largest palindrome made
  from the product of two 2-digit numbers is 9009 = 91*99.

  Find the largest palindrome made from the product of two 3-digit numbers.
  \end{block}
\end{frame}

\begin{frame}[fragile]{Solution (1)}
  TODO
\end{frame}

\begin{frame}[fragile]{Solution(2)}
  TODO
\end{frame}

\section{Option Types}
\frame{\tableofcontents[currentsection]}

\begin{frame}{List searching}
  \begin{itemize}[<+->]
    \item \texttt{List.find : (('a -> bool) -> 'a list -> 'a)}
    \item What if element is not found in list?
    \item Runtime error...
    \item Fail if precondition is unmet
    \item Need way to signal that functions might fail
    \item \texttt{List.tryFind :\\ (('a -> bool) -> 'a list -> 'a option)}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]{Option}
  \begin{itemize}
    \item \texttt{None} - no value to return
    \item \texttt{Some x} - result available
  \end{itemize}
  \pause
  \begin{verbatim}
  > let safediv x y =
          match y with
              | 0 -> None
              | _ -> Some(x/y);;
  \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Option is not \texttt{null}}
  \begin{itemize}
    \item conceptually similar
    \item different semantics
    \item programmer \textbf{forced} to treat both cases
  \end{itemize}
  \begin{verbatim}
  val div : int -> int -> int
  val safediv : int -> int -> int option
  \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Pattern Matching}
  \begin{verbatim}
  > let isFortyTwo = function
        | Some(42) -> true
        | Some(_) -> false
        | None -> false;;
  \end{verbatim}
\end{frame}

\begin{frame}{Other Functions}
  \begin{itemize}[<+->]
    \item \texttt{get : 'a option -> 'a}
    \item \texttt{isNone, isSome : 'a option -> bool}
    \item \texttt{map : ('a -> 'b) -> 'a option -> 'b option}
    \item \texttt{iter : ('a -> unit) -> 'a option -> unit}
  \end{itemize}
\end{frame}

\section{Records}
\frame{\tableofcontents[currentsection]}

\begin{frame}[label=tuples]{Tuples}
  \begin{itemize}
    \item \texttt{(3.14, "Ana", 42)}
    \item semantics?
    \item extracting values?
    \item cloning?
    \item type safety? (\texttt{point2D} vs \texttt{pair})
  \end{itemize}
\end{frame}

\begin{frame}[fragile]{Records}
  \begin{itemize}
    \item giving name to values in tuples
    \item method to properly extract values
  \end{itemize}
  \begin{verbatim}
  > type website = { Title : string; Url : string };;
  > let homepage = { Title = "Google";
        Url = "http://www.google.com" };;
  > { Url = "http://www.microsoft.com/";
        Title = "Microsoft Corporation" };;
  > website.Title;;
  \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Cloning Records}
  \begin{itemize}
    \item immutable
    \item changing = creating a clone
  \end{itemize}
  \begin{verbatim}
  > type coords = { X : float; Y : float };;
  > let start = { X = 1.0; Y = 2.0 };;
  > let end = { start with X = 15.5 };;
  \end{verbatim}
\end{frame}

\begin{frame}[fragile]{Pattern Matching}
  \begin{verbatim}
type coords = { X : float; Y : float }
 
let getQuadrant = function
    | { X = 0.0; Y = 0.0 } -> "Origin"
    | item when item.X >= 0.0 && item.Y >= 0.0 -> "I"
    | item when item.X <= 0.0 && item.Y >= 0.0 -> "II"
    | item when item.X <= 0.0 && item.Y <= 0.0 -> "III"
    | item when item.X >= 0.0 && item.Y <= 0.0 -> "IV"
  \end{verbatim}
\end{frame}

\section{Sets and Maps}
\frame{\tableofcontents[currentsection]}

\begin{frame}{Sets}
  TODO
\end{frame}

\begin{frame}{Maps}
  TODO
\end{frame}

\begin{frame}{Performance}
  TODO
\end{frame}

\section{Discriminated Unions}
\frame{\tableofcontents[currentsection]}

\againframe{tuples}

\begin{frame}{Unions of Constructors}
  TODO
\end{frame}

\begin{frame}{Sum and Product Types}
  TODO
\end{frame}

\begin{frame}{Union of All Datatypes}
  TODO: type variables in constructors
\end{frame}

\begin{frame}{Pattern Matching}
  TODO
\end{frame}

\begin{frame}{Known Union Types}
  TODO: list, option
\end{frame}

\begin{frame}{Propositional Logic (Example)}
  TODO: work with them
\end{frame}

\begin{frame}{Stacks (Example)}
  TODO: same (stack == list)
\end{frame}

\begin{frame}{Queue (Example)}
  TODO: same + 2 stacks
\end{frame}

\begin{frame}{Binary Trees (Example)}
  TODO: same
\end{frame}

\section{Lazy Data Structures}
\frame{\tableofcontents[currentsection]}

\begin{frame}{Efficiency of Eager Immutable Data Structures}
  TODO
\end{frame}

\begin{frame}{A Lazy Stack}
  TODO
\end{frame}

\begin{frame}{Why Immutability?}
  TODO
\end{frame}

\begin{frame}{Immutable Data Structures in Imperative Code?}
  TODO
\end{frame}

\section{Caching Results}
\frame{\tableofcontents[currentsection]}

\begin{frame}{Immutability = Multiple Copies}
  TODO
\end{frame}

\begin{frame}{Caching Pointfree Functions}
  TODO
\end{frame}

\begin{frame}{Fibonacci Function}
  TODO
\end{frame}

\begin{frame}{Memoization}
  TODO
\end{frame}

\begin{frame}{Generic Memoizer}
  TODO
\end{frame}

\begin{frame}{Performance Concerns}
  TODO: profile, premature optimization...
\end{frame}

\begin{frame}{Lazy Values and Caching}
  TODO
\end{frame}

\section{Finishing slides}
\frame{\tableofcontents[currentsection]}

\begin{frame}{Units of Measure :: Why}
  TODO
\end{frame}

\begin{frame}{Units of Measure :: How}
  TODO
\end{frame}

\begin{frame}{Units of Measure :: Generalizing}
  TODO
\end{frame}

\begin{frame}{Recap}
  \begin{itemize}[<+->]
    \item option types
    \item records
    \item sets and maps
    \item discriminated unions
    \item caching
    \item units of measure
  \end{itemize}
\end{frame}

\begin{frame}{Resources}
  \begin{itemize}
    \item Chris Okasaki - \textit{Functional Data Structures}
    \item Steve Skiena - \textit{The Algorithm Design Manual}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]{Assignment}
  \begin{itemize}
    \item optional
    \item send via mail (\texttt{mihai@rosedu.org})
    \item next talk will start with discussion of solutions
  \end{itemize}
  \pause
  \begin{block}{Joining tables}
  TODO
  \end{block}
\end{frame}

\end{document}
